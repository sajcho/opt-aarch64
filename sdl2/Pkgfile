# Description:	Development library designed to provide low level access to audio, keyboard, mouse, joystick and graphics
# URL:		https://www.libsdl.org
# Maintainer:	sajcho, saux dot aarch64 at gmail dot com
# Depends on:	alsa-lib libdecor libusb libxkbcommon xwayland

name=sdl2
_realname=SDL2
version=2.0.18
release=1
source=(https://www.libsdl.org/release/${_realname}-${version}.tar.gz \
	khronos.patch)

build() {
	cd ${_realname}-${version}

	patch -p1 -i $SRC/khronos.patch

	mkdir build
	cd build

	cmake .. -G Ninja \
		-DCMAKE_BUILD_TYPE=None \
		-DCMAKE_INSTALL_PREFIX=/usr \
		-DCMAKE_INSTALL_LIBDIR=lib \
		-DCMAKE_C_FLAGS="$CFLAGS" \
		-DBUILD_SHARED_LIBS=ON \
		-DSDL_SHARED=ON \
		-DSDL_CLOCK_GETTIME=ON \
		-DSDL_TEST=OFF \
		-DSDL_STATIC=OFF \
		-DSDL_ALSA=ON \
		-DSDL_WAYLAND=ON \
		-DSDL_WAYLAND_LIBDECOR=ON \
		-DSDL_X11=ON \
		-DSDL_ARTS=OFF \
		-DSDL_ESD=OFF \
		-DSDL_JACK=OFF \
		-DSDL_PIPEWIRE=OFF \
		-DSDL_PULSEAUDIO=OFF \
		-DSDL_NAS=OFF \
		-DSDL_RPATH=OFF

	ninja -v

	DESTDIR=$PKG ninja install

	find $PKG -type f -name '*.a' -delete
}
