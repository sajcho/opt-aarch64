# Description:	Ruby extension for openssl3.
# URL:		https://github.com/ruby/openssl/
# Maintainer:	sajcho, saux dot aarch64 at gmail dot com
# Depends on:	ruby

name=ruby-openssl
_gemname=openssl
version=3.0.0
release=1
source=(https://github.com/ruby/openssl/archive/v${version}/${name}-${version}.tar.gz)


build() {
	cd ${_gemname}-${version}

	gem build ${_gemname}.gemspec

	local gemdir="$PKG/$(ruby -e 'puts Gem.default_dir')"

	gem install \
		--local \
		--install-dir "${gemdir}" \
		--bindir "$PKG/usr/bin" \
		--ignore-dependencies \
		--verbose \
		${_gemname}

	# Remove unnessecary files
	cd "${gemdir}"
	rm -r build_info cache doc plugins

	find $PKG -type f \
		-name '*.md' -o \
		-name '*.txt' -o \
		-name 'BSDL' | xargs rm
}
