# Description:	daemon, tools and libraries to manipulate disks
# URL:		https://www.freedesktop.org/wiki/Software/udisks/
# Maintainer:	sajcho, saux dot aarch64 at gmail dot com
# Depends on:	coreutils dbus glib gobject-introspection intltool libatasmart libblockdev polkit

name=udisks2
_realname=udisks
version=2.9.4
release=1
source=(https://github.com/storaged-project/udisks/releases/download/udisks-${version}/udisks-${version}.tar.bz2 \
	O_CLOEXEC.patch)

build() {
	cd ${_realname}-${version}

	patch -p1 -i $SRC/O_CLOEXEC.patch

	./configure \
		--prefix=/usr \
		--sysconfdir=/etc \
		--libexecdir=/usr/lib \
		--localstatedir=/var \
		--enable-lvm2 \
		--enable-lvmcache \
		--disable-static \
		--disable-zram \
		--with-udevdir=/lib/udev

	make V=1

	make DESTDIR=$PKG install

	rm -r $PKG/usr/share/{bash-completion,gtk-doc,locale}

	find $PKG -type f -name '*.la' -delete
}
