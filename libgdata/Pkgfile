# Description:	Access library for gdata
# URL:		https://wiki.gnome.org/Projects/libgdata
# Maintainer:	sajcho, saux dot aarch64 at gmail dot com
# Depends on:	gcr glib gnome-online-accounts gobject-introspection gsettings-desktop-schemas intltool json-glib liboauth libsoup meson uhttpmock

name=libgdata
version=0.18.1
release=0
source=(https://download.gnome.org/sources/${name}/${version%.*}/${name}-${version}.tar.xz \
	only-ipv4-tests.patch \
	disable-perf-test.patch)

build() {
	cd ${name}-${version}

	patch -p1 -i $SRC/only-ipv4-tests.patch
	patch -p1 -i $SRC/disable-perf-test.patch

	build-meson \
		-Dintrospection=true \
		-Dman=true \
		-Dgoa=enabled \
		-Dgtk=enabled \
		-Dgnome=enabled \
		-Dvapi=false \
		-Dgtk_doc=false \
		. build

	meson compile ${JOBS:+-j ${JOBS}} -C build

	#meson test --no-rebuild -C build

	DESTDIR=$PKG meson install --no-rebuild -C build

	rm -r $PKG/usr/share/locale
}
