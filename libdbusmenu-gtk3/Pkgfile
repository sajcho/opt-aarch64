# Description:	Library for passing menus over DBus - Glib part
# URL:		https://launchpad.net/libdbusmenu
# Maintainer:	sajcho, saux dot aarch64 at gmail dot com
# Depends on:	glib gnome-common gobject-introspection gtk3 json-glib intltool

name=libdbusmenu-gtk3
_realname=libdbusmenu
version=16.04.0
release=0
source=(https://launchpad.net/${_realname}/16.04/${version}/+download/${_realname}-${version}.tar.gz)

build() {
	cd ${_realname}-${version}

	export HAVE_VALGRIND_TRUE='#'
	export HAVE_VALGRIND_FALSE=''
	export CFLAGS="$CFLAGS -Wno-error"

	./configure \
		--prefix=/usr \
		--sysconfdir=/etc \
		--localstatedir=/var \
		--libexecdir=/usr/lib/${name} \
		--enable-introspection \
		--disable-{dumper,nls,static,tests,vala} \
		--with-gtk=3

	make -j1

	make -j1 DESTDIR=$PKG install

	# provide port libdbusmenu-glib
	rm -r $PKG/usr/include/libdbusmenu-glib-0.4
	rm $PKG/usr/lib/libdbusmenu-glib*
	rm $PKG/usr/lib/girepository-1.0/Dbusmenu-0.4.typelib
	rm $PKG/usr/lib/pkgconfig/dbusmenu-glib-0.4.pc
	rm $PKG/usr/share/gir-1.0/Dbusmenu-0.4.gir

	rm -r $PKG/usr/{lib/libdbusmenu-gtk3,share/{doc,gtk-doc}}
}
