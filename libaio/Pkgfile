# Description:	Asynchronous input/output library
# URL:		https://pagure.io/libaio
# Maintainer:	sajcho, saux dot aarch64 at gmail dot com

name=libaio
version=0.3.112
release=1
source=(https://releases.pagure.org/${name}/${name}-${version}.tar.gz \
	libaio-optional-werror.patch \
	libaio-cppflags.patch \
	libaio-errno.patch)

build() {
	cd ${name}-${version}

	# build libaio with lto failed - disable
	export CFLAGS="$(echo $CFLAGS | sed -e 's| -flto=auto -ffat-lto-objects||')"

	patch -p1 -i $SRC/libaio-optional-werror.patch
	patch -p1 -i $SRC/libaio-cppflags.patch
	patch -p1 -i $SRC/libaio-errno.patch

	make prefix="$PKG/usr" install

	find $PKG -type f -name '*.a' -delete
}
