# Description:	Compiler runtime libraries for clang
# URL:		https://compiler-rt.llvm.org/
# Maintainer:	Milan Buska, milan dot buska at gmail dot com
# Depends on:	llvm cmake ninja python3

name=compiler-rt
version=10.0.1
release=1
source=(https://github.com/llvm/llvm-project/releases/download/llvmorg-$version/compiler-rt-$version.src.tar.xz)

build() {
	cd $name-$version.src

	mkdir build
	cd build

	cmake .. -G Ninja \
		-DCMAKE_BUILD_TYPE=Release \
		-DCMAKE_INSTALL_PREFIX=/usr \
		-DCMAKE_C_COMPILER=clang \
		-DCMAKE_CXX_COMPILER=clang++

	ninja
	DESTDIR=$PKG ninja install

	mkdir -p $PKG/usr/lib/clang/$version/{lib,share}
	mv $PKG/usr/lib/{linux,clang/$version/lib/}
	mv $PKG/usr/{share/*.txt,lib/clang/$version/share/}
}
