# Description:	Small, efficient and fast rendering engine for Web Browsers.
# URL:		https://www.webkitgtk.org/
# Maintainer:	sajcho, saux dot aarch64 at gmail dot com
# Depends on: 	cmake enchant2 geoclue gst-plugins-base gtk2 gtk3 libnotify libseccomp libsecret libsoup libwebp libwpe libwpebackend-fdo libxslt openjpeg2 ruby woff2 libxt

name=webkitgtk
version=2.34.0
release=0
source=(https://webkitgtk.org/releases/${name}-${version}.tar.xz)

build() {
	cd ${name}-${version}

	mkdir build
	cd build

	cmake .. -G Ninja \
		-DCMAKE_BUILD_TYPE=None \
		-DCMAKE_INSTALL_PREFIX:PATH=/usr \
		-DCMAKE_INSTALL_LIBDIR:PATH=/usr/lib \
		-DCMAKE_INSTALL_LIBEXECDIR:PATH=/usr/lib \
		-DCMAKE_SKIP_RPATH=ON \
		-DPORT=GTK \
		-DENABLE_MINIBROWSER=ON \
		-DENABLE_GEOLOCATION=ON \
		-DENABLE_SPELLCHECK=ON \
		-DUSE_WPE_RENDERER=ON \
		-DUSE_OPENJPEG=ON \
		-DUSE_LIBNOTIFY=ON \
		-DUSE_SYSTEM_MALLOC=ON \
		-DUSE_SOUP2=ON \
		-DUSE_WOFF2=ON \
		-DUSE_SYSTEMD=OFF \
		-DUSE_LD_GOLD=OFF \
		-DUSE_LIBHYPHEN=OFF \
		-DENABLE_GAMEPAD=OFF \
		-DENABLE_JIT=OFF \
		-DENABLE_SAMPLING_PROFILER=OFF \
		-DENABLE_BUBBLEWRAP_SANDBOX=OFF \
		-Wno-dev

	# https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=923476
	ninja JavaScriptCore-4-gir

	ninja

	DESTDIR=$PKG ninja -C $SRC/${name}-${version}/build install

	rm -r $PKG/usr/share/locale
}
